# 계층형 아키텍처의 문제점은 무엇인가?

 ![image](https://user-images.githubusercontent.com/79154652/179990342-086247e3-ba08-4f07-8423-372cc9951aff.png)
 
 위 그림은 전통적인 웹계층, 도메인계층, 영속성 계층으로 구성된 웹 어플리케이션 구조이다.
 
 
 웹 계층 에서 `요청` 을 받는다 -> 도메인 or 비즈니스 계층에 있는 서비스로 요청을 보낸다 -> 서비스에서는 비즈니스 로직을 수행한다 -> 도메인 엔티티의 상태 조회나 변경을 위해 `영속성계층`의 컴포넌트를 호출한다.
 
 - 계층형 아키텍처는 계층을 잘 이해하고 구성한다면 웹 계층이나 영속성 계층에 독립적으로 도메인 로직을 작성할 수 있다.

 - but? 계층형 아키텍처의 문제점은 무엇일까?
    - 계층형 아키텍처는 `데이터베이스`를 토대로 한다.
    - 웹 -> 도메인 계층 의존, 도메인 -> 영속성 계층 의존, 이렇기 때문에 자연스레 데이터베이스에 의존하게 된다.
    - 우리는 도메인 로직을 먼저 구현하지않고 항상 데이터베이스 구조를 생각하고 도메인 로직을 구현한다.
    - 전통적인 계층형 아키텍처에서는 합리적인 방법이다. 하지만 비즈니스 관점에서는 전혀 맞지 않는 방법이다.
    - 데이터베이스 중심적인 아키텍처가 만들어지는 가장 큰 원인은 ORM(object-relational mapping, 객체 관계 매핑) 프레임워크를 사용하기 때문이다.
 
 - 계층형 아키텍처를 사용할 때 일반적으로 나타는 변화의 형태는 계층을 건너 뛰는 것이다. 이러한 일이 자주 발생하게 된다면 아래와 같은 문제가 발생한다.
    - 단 하나의 필드를 조작하는 것에 불과하더라도 도메인 로직을 웹 계층에 구현하게 된다는 것이다.
    - 웹 계층 테스트에서 도메인 계층뿐 만 아니라 영속성 계층도 모킹을 해야 한다. 이렇게 되면 단위 테스트의 복잡도가 올라간다.
